<!DOCTYPE html>
<html lang="pt-br">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Documentação da API</title>
    <link
      href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css"
    />
    <style>
      body {
        font-family: "Roboto", sans-serif;
        margin: 0;
        padding: 0;
        background-color: #f0f2f5;
        color: #333;
      }

      header {
        background: #343a40;
        color: #fff;
        padding: 1em 0;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      }

      header h1 {
        text-align: center;
        margin: 0;
        font-size: 1.8em;
      }

      header nav {
        text-align: center;
        margin-top: 0.5em;
      }

      header nav ul {
        list-style: none;
        padding: 0;
      }

      header nav ul li {
        display: inline;
        margin: 0 1em;
      }

      header nav ul li a {
        color: #fff;
        text-decoration: none;
        font-size: 1.1em;
        transition: color 0.3s;
      }

      header nav ul li a:hover {
        color: #17a2b8;
      }

      section {
        padding: 3em 0;
        border-bottom: 1px solid #ddd;
      }

      .container {
        width: 80%;
        margin: auto;
        overflow: hidden;
      }

      h2 {
        color: #343a40;
        text-align: center;
        margin-bottom: 1em;
        font-size: 2em;
      }

      .endpoint {
        background: #fff;
        padding: 1.5em;
        margin: 1.5em 0;
        border-radius: 8px;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        transition: transform 0.3s;
        cursor: pointer;
      }

      .endpoint:hover {
        transform: scale(1.02);
      }

      .method {
        font-weight: bold;
        color: #fff;
        display: inline-block;
        padding: 0.5em 1em;
        border-radius: 4px;
        margin-right: 10px;
      }

      .method.get {
        background: #28a745;
      }

      .method.post {
        background: #007bff;
      }

      .method.put {
        background: #ffc107;
      }

      .method.delete {
        background: #dc3545;
      }

      .endpoint strong {
        font-size: 1.2em;
      }

      .endpoint p {
        margin: 0.5em 0 0 2.5em;
        font-size: 1.1em;
      }

      .test-section {
        padding: 1em;
        background: #f9f9f9;
        border: 1px solid #ddd;
        border-radius: 5px;
        margin-top: 1em;
      }

      .test-section label {
        display: block;
        margin-top: 0.5em;
      }

      .test-section input,
      .test-section textarea,
      .test-section select {
        width: 100%;
        padding: 0.5em;
        margin-top: 0.5em;
        border: 1px solid #ccc;
        border-radius: 4px;
      }

      .test-section button {
        display: block;
        background: #007bff;
        color: #fff;
        border: none;
        padding: 0.7em 1.5em;
        border-radius: 5px;
        cursor: pointer;
        margin-top: 1em;
        transition: background 0.3s;
      }

      .test-section button:hover {
        background: #0056b3;
      }

      footer {
        background: #343a40;
        color: #fff;
        text-align: center;
        padding: 1em 0;
        margin-top: 3em;
      }

      footer p {
        margin: 0;
      }

      /* CSS para ocultar o campo de requisição quando o método for GET ou DELETE */
      .request-body.hidden {
        display: none;
      }
    </style>
  </head>
  <body>
    <header>
      <div class="container">
        <h1>Documentação da API</h1>
        <nav>
          <ul>
            <li><a href="#notificacoes">Notificações</a></li>
          </ul>
        </nav>
      </div>
    </header>

    <section id="notificacoes">
      <div class="container">
        <h2>Notificações</h2>

        <div
          class="endpoint"
          data-endpoint="/notification-api/cadastrar"
          data-method="POST"
        >
          <span class="method post">POST</span>
          <strong>/notification-api/cadastrar</strong>
          <p>Cadastrar algo qualquer</p>
          <div class="test-section" style="display: none">
            <div class="container">
              <form class="test-form">
                <label for="endpoint-url">URL do Endpoint:</label>
                <input type="text" class="endpoint-url" />
                <label for="request-method">Método:</label>
                <select class="request-method">
                  <option value="GET">GET</option>
                  <option value="POST">POST</option>
                  <option value="PUT">PUT</option>
                  <option value="DELETE">DELETE</option>
                </select>
                <label for="request-body">Corpo da Requisição (JSON):</label>
                <textarea class="request-body" rows="5"></textarea>
                <button type="submit">Enviar</button>
              </form>

              <h3>Resposta:</h3>
              <pre class="response-output"></pre>
            </div>
          </div>
        </div>
      </div>
    </section>

    <footer>
      <div class="container">
        <p>Documentação da API &copy; 2024</p>
      </div>
    </footer>

    <script>
      document.querySelectorAll(".endpoint").forEach((endpoint) => {
        const postMethodSpan = endpoint.querySelector(".method.post");
        postMethodSpan.addEventListener("click", function (e) {
          const url = endpoint.dataset.endpoint;
          const method = endpoint.dataset.method;
          let formSection = endpoint.querySelector(".test-section");

          if (!formSection) {
            formSection = document.createElement("div");
            formSection.classList.add("test-section");

            formSection.innerHTML = `
                <div class="container">
                    <form class="test-form">
                        <label for="endpoint-url">URL do Endpoint:</label>
                        <input type="text" class="endpoint-url" />
                        <label for="request-method">Método:</label>
                        <select class="request-method">
                            <option value="GET">GET</option>
                            <option value="POST">POST</option>
                            <option value="PUT">PUT</option>
                            <option value="DELETE">DELETE</option>
                        </select>
                        <label for="request-body">Corpo da Requisição (JSON):</label>
                        <textarea class="request-body" rows="5"></textarea>
                        <button type="submit">Enviar</button>
                    </form>

                    <h3>Resposta:</h3>
                    <pre class="response-output"></pre>
                </div>
            `;
            endpoint.appendChild(formSection);
          }

          if (formSection.style.display === "block") {
            formSection.style.display = "none";
          } else {
            formSection.style.display = "block";
            formSection.querySelector(".endpoint-url").value = url;
            formSection.querySelector(".request-method").value = method;

            const form = formSection.querySelector(".test-form");
            const requestBodyField = form.querySelector(".request-body");

            // Oculta o campo de corpo da requisição se o método for GET ou DELETE
            if (method === "GET" || method === "DELETE") {
              requestBodyField.style.display = "none";
            } else {
              requestBodyField.style.display = "block";
            }
          }
        });

        endpoint
          .querySelector(".test-form")
          .addEventListener("submit", async function (e) {
            e.preventDefault();

            const url = this.querySelector(".endpoint-url").value;
            const method = this.querySelector(".request-method").value;
            const requestBodyTextArea = this.querySelector(".request-body");

            let options = {
              method: method,
              headers: {
                "Content-Type": "application/json",
                "Cache-Control": "no-cache",
              },
            };

            const requestBodyString = requestBodyTextArea.value.trim();

            if (method !== "GET" && method !== "DELETE" && requestBodyString) {
              try {
                const parsedBody = JSON.parse(requestBodyString);
                options.body = JSON.stringify(parsedBody);
              } catch (error) {
                const formSection = this.closest(".test-section");
                formSection.querySelector(
                  ".response-output"
                ).textContent = `Erro ao analisar JSON: ${error.message}`;
                return;
              }
            }

            try {
              const response = await fetch(url, options);
              const contentType = response.headers.get("content-type");
              let data;

              if (contentType && contentType.includes("application/json")) {
                data = await response.json();
              } else {
                data = await response.text();
              }

              const formSection = this.closest(".test-section");
              formSection.querySelector(".response-output").textContent =
                JSON.stringify(data, null, 2);
            } catch (error) {
              console.error("Erro na requisição:", error);
              const formSection = this.closest(".test-section");
              formSection.querySelector(
                ".response-output"
              ).textContent = `Erro: ${error.message}`;
            }
          });

        // Oculta o campo de corpo da requisição se o método for GET ou DELETE
        endpoint
          .querySelector(".request-method")
          .addEventListener("change", function () {
            const method = this.value;
            const form = this.closest(".test-form");
            const requestBodyField = form.querySelector(".request-body");

            if (method === "GET" || method === "DELETE") {
              requestBodyField.style.display = "none";
            } else {
              requestBodyField.style.display = "block";
            }
          });
      });
    </script>
  </body>
</html>
